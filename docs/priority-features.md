# 優先機能仕様書

## 1. 最高優先度機能

### 1.1 重複ファイル検出・処理
- **ハッシュ値による完全一致検出**
  - MD5、SHA-256によるファイル内容の完全一致検出
  - 高速化のためのファイルサイズ事前チェック
- **重複時の処理選択**
  - スキップ、上書き、別名保存、ユーザー選択の4つのオプション
  - 一括処理とファイル毎の個別選択

### 1.2 カスタムルールによる整理
- **ルールエンジン**
  - 条件分岐による柔軟な整理ルール
  - 複数ルールの組み合わせ実行
  - IF-THEN-ELSE形式での条件設定
- **利用可能な条件**
  - 撮影日時（年、月、日、時間帯）
  - ファイル形式（拡張子、MIME Type）
  - デバイス情報（カメラ機種、スマートフォン機種）
  - ファイルサイズ
  - 解像度（写真・動画）
  - 場所情報（GPS座標、地名）

## 2. 高優先度機能

### 2.1 入力元対応
- **スマートフォン（iOS/Android）**
  - MTP/PTP プロトコル対応
  - USB接続時の自動検出
  - DCIM フォルダの自動認識
- **デジタルカメラ（USB/SDカード）**
  - 複数のSDカードスロット対応
  - RAW + JPEG のペアファイル認識
  - 動画ファイルの関連メタデータ取得

### 2.2 出力先対応
- **ローカルストレージ**
  - 複数ドライブ対応
  - 空き容量チェック
- **クラウドストレージ**
  - **Dropbox API v2**
  - **OneDrive Graph API**
  - **Amazon S3 API**
  - OAuth2.0認証による安全な接続

### 2.3 GUI機能
- **ドラッグ＆ドロップ対応**
  - ファイル、フォルダの直接ドロップ
  - 複数ファイルの一括選択
- **プレビュー機能**
  - 画像のサムネイル表示
  - 動画の最初のフレーム表示
  - メタデータ情報の表示
- **転送前確認画面**
  - 転送対象ファイル一覧
  - 適用される整理ルールの確認
  - 転送先の確認

### 2.4 定型処理・自動化
- **ジョブ管理機能**
  - GUI上でのジョブ作成
  - 作成したジョブの保存・読み込み
  - コマンドラインからのジョブ実行
- **設定プロファイル**
  - 入力元、出力先、整理ルールの組み合わせ
  - 複数プロファイルの管理

## 3. 中優先度機能

### 3.1 動画特化機能
動画ファイルの整理が困難という課題に対する特別対応：

- **動画メタデータ解析**
  - 撮影日時の正確な取得
  - 解像度、フレームレート、コーデック情報
  - 撮影時間の長さ
- **動画関連ファイルの一括管理**
  - 動画 + サムネイル + 字幕ファイルの関連付け
  - 同一イベントの動画ファイルのグループ化
- **動画専用整理ルール**
  - 撮影時間の長さによる分類
  - 解像度による分類（4K、フルHD、HD等）
  - フレームレートによる分類

### 3.2 追加検出機能
- **ファイル名による重複検出**
  - 類似ファイル名のパターンマッチング
  - 連番ファイルの検出
- **類似画像検出**
  - パーセプチュアルハッシュを使用した類似画像検出
  - 類似度閾値の設定

## 4. 低優先度機能

### 4.1 テンプレート機能
- 日付別フォルダ作成テンプレート
- イベント別フォルダ作成テンプレート
- デバイス別フォルダ作成テンプレート
- ファイル形式別フォルダ作成テンプレート

### 4.2 高度な機能
- **ファイル変換機能**
  - 画像リサイズ
  - フォーマット変換
- **スケジュール実行**
  - 定期的な自動実行
  - 監視フォルダでの自動処理

## 5. 技術的考慮事項

### 5.1 動画ファイル対応の重要性
- 大容量ファイル（4GB以上）の効率的な処理
- 動画メタデータの正確な読み取り
- 複数の動画フォーマット対応（MP4、MOV、AVI、MKV等）

### 5.2 パフォーマンス
- 大量ファイル処理のためのマルチスレッド化
- メモリ効率の最適化
- 進捗表示とキャンセル機能

### 5.3 エラー処理
- 転送中断時の再開機能
- 詳細なエラーログ
- 部分的な失敗時の処理継続